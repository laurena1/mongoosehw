//bring in the module
var mongoose = require('mongoose');


var connString = "mongodb://" + process.env.IP + ":27017/";
var dbName = "studentsdb";

//connect
var db = mongoose.connect(connString + dbName);

//get the schema - notice how we use the export
var studentSchema = require('./mongoose_word_schema.js').studentSchema;

//make the model - assocated it with the schema
var Students = mongoose.model('Students', studentSchema);

//for disonnecting
setTimeout(function() {
    mongoose.disconnect();
}, 3000);

//once is very close in meaning to "on" and is an event handling "hook" for you
//to associate with a callback
mongoose.connection.once('open', function() {
    
    
    var query = Students.find();
    query.exec(function(err, docs) {
        
        for(var i in docs)
        {
            console.log(docs[i].first + " "  + docs[i].last);   
            }
        
        console.log("\nThese are the students");
    });
});